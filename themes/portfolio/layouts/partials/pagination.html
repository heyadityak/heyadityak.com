{{- with .Paginator -}}
{{- if gt .TotalPages 1 -}}
{{- $pag := . -}}
<nav class="mt-12 flex items-center justify-center" aria-label="Pagination">
  <ul class="flex items-center gap-1">
    {{- /* First page */ -}}
    {{- if $pag.HasPrev -}}
    <li>
      <a href="{{ $pag.First.URL }}" class="flex items-center justify-center w-10 h-10 rounded-lg bg-gray-100 dark:bg-dark-card text-gray-600 dark:text-gray-400 hover:bg-primary-100 hover:text-primary-600 dark:hover:bg-primary-800 dark:hover:text-primary-400 transition-colors" aria-label="First page">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7"/>
        </svg>
      </a>
    </li>
    {{- end -}}

    {{- /* Previous page */ -}}
    {{- if $pag.HasPrev -}}
    <li>
      <a href="{{ $pag.Prev.URL }}" class="flex items-center justify-center w-10 h-10 rounded-lg bg-gray-100 dark:bg-dark-card text-gray-600 dark:text-gray-400 hover:bg-primary-100 hover:text-primary-600 dark:hover:bg-primary-800 dark:hover:text-primary-400 transition-colors" aria-label="Previous page">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
      </a>
    </li>
    {{- else -}}
    <li>
      <span class="flex items-center justify-center w-10 h-10 rounded-lg bg-gray-50 dark:bg-dark-card/50 text-gray-300 dark:text-gray-600 cursor-not-allowed" aria-disabled="true">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
      </span>
    </li>
    {{- end -}}

    {{- /* Page numbers */ -}}
    {{- $currentPage := $pag.PageNumber -}}
    {{- $totalPages := $pag.TotalPages -}}
    {{- $maxVisible := 5 -}}
    {{- $half := 2 -}}
    
    {{- $startPage := math.Max 1 (sub $currentPage $half) -}}
    {{- $endPage := math.Min $totalPages (add $currentPage $half) -}}
    
    {{- if lt (sub $endPage $startPage) (sub $maxVisible 1) -}}
      {{- if eq $startPage 1 -}}
        {{- $endPage = math.Min $totalPages $maxVisible -}}
      {{- else -}}
        {{- $startPage = math.Max 1 (add (sub $totalPages $maxVisible) 1) -}}
      {{- end -}}
    {{- end -}}

    {{- /* First page link if not in range */ -}}
    {{- if gt $startPage 1 -}}
    <li>
      <a href="{{ $pag.First.URL }}" class="flex items-center justify-center w-10 h-10 rounded-lg bg-gray-100 dark:bg-dark-card text-gray-600 dark:text-gray-400 hover:bg-primary-100 hover:text-primary-600 dark:hover:bg-primary-800 dark:hover:text-primary-400 transition-colors">
        1
      </a>
    </li>
    {{- if gt $startPage 2 -}}
    <li>
      <span class="flex items-center justify-center w-10 h-10 text-gray-400 dark:text-gray-500">…</span>
    </li>
    {{- end -}}
    {{- end -}}

    {{- /* Page number links */ -}}
    {{- range $pag.Pagers -}}
      {{- $pageNum := .PageNumber -}}
      {{- if and (ge $pageNum $startPage) (le $pageNum $endPage) -}}
      <li>
        {{- if eq $pageNum $currentPage -}}
        <span class="flex items-center justify-center w-10 h-10 rounded-lg bg-primary-600 text-white font-medium" aria-current="page">
          {{ $pageNum }}
        </span>
        {{- else -}}
        <a href="{{ .URL }}" class="flex items-center justify-center w-10 h-10 rounded-lg bg-gray-100 dark:bg-dark-card text-gray-600 dark:text-gray-400 hover:bg-primary-100 hover:text-primary-600 dark:hover:bg-primary-800 dark:hover:text-primary-400 transition-colors">
          {{ $pageNum }}
        </a>
        {{- end -}}
      </li>
      {{- end -}}
    {{- end -}}

    {{- /* Last page link if not in range */ -}}
    {{- if lt $endPage $totalPages -}}
    {{- if lt (add $endPage 1) $totalPages -}}
    <li>
      <span class="flex items-center justify-center w-10 h-10 text-gray-400 dark:text-gray-500">…</span>
    </li>
    {{- end -}}
    <li>
      <a href="{{ $pag.Last.URL }}" class="flex items-center justify-center w-10 h-10 rounded-lg bg-gray-100 dark:bg-dark-card text-gray-600 dark:text-gray-400 hover:bg-primary-100 hover:text-primary-600 dark:hover:bg-primary-800 dark:hover:text-primary-400 transition-colors">
        {{ $totalPages }}
      </a>
    </li>
    {{- end -}}

    {{- /* Next page */ -}}
    {{- if $pag.HasNext -}}
    <li>
      <a href="{{ $pag.Next.URL }}" class="flex items-center justify-center w-10 h-10 rounded-lg bg-gray-100 dark:bg-dark-card text-gray-600 dark:text-gray-400 hover:bg-primary-100 hover:text-primary-600 dark:hover:bg-primary-800 dark:hover:text-primary-400 transition-colors" aria-label="Next page">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
        </svg>
      </a>
    </li>
    {{- else -}}
    <li>
      <span class="flex items-center justify-center w-10 h-10 rounded-lg bg-gray-50 dark:bg-dark-card/50 text-gray-300 dark:text-gray-600 cursor-not-allowed" aria-disabled="true">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
        </svg>
      </span>
    </li>
    {{- end -}}

    {{- /* Last page */ -}}
    {{- if $pag.HasNext -}}
    <li>
      <a href="{{ $pag.Last.URL }}" class="flex items-center justify-center w-10 h-10 rounded-lg bg-gray-100 dark:bg-dark-card text-gray-600 dark:text-gray-400 hover:bg-primary-100 hover:text-primary-600 dark:hover:bg-primary-800 dark:hover:text-primary-400 transition-colors" aria-label="Last page">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"/>
        </svg>
      </a>
    </li>
    {{- end -}}
  </ul>
</nav>

{{- /* Page info */ -}}
<p class="mt-4 text-center text-sm text-gray-500 dark:text-gray-400">
  Page {{ $pag.PageNumber }} of {{ $pag.TotalPages }}
</p>
{{- end -}}
{{- end -}}
